# These settings were set by the catalyst build script that automatically
# built this stage.
# Please consult /usr/share/portage/config/make.conf.example for a more
# detailed example.
COMMON_FLAGS="-march=native -O2 -pipe"

CFLAGS="${COMMON_FLAGS}"
CXXFLAGS="${COMMON_FLAGS}"
FCFLAGS="${COMMON_FLAGS}"
FFLAGS="${COMMON_FLAGS}"

# Rust flags
RUSTFLAGS="${RUSTFLAGS} -C target-cpu=native -C opt-level=3"

# Portage
{{- if eq .kind "vm" }}
MAKEOPTS="-j4 -l4"
EMERGE_DEFAULT_OPTS="${EMERGE_DEFAULT_OPTS} --ask --verbose --verbose-conflicts --with-bdeps=y --complete-graph=y --keep-going --jobs=4 --load-average=4.0"
{{- else }}
MAKEOPTS="-j12 -l12"
EMERGE_DEFAULT_OPTS='${EMERGE_DEFAULT_OPTS} --ask --verbose --verbose-conflicts --with-bdeps=y --complete-graph=y --keep-going --jobs=12 --load-average=12.0'
{{- end }}
ACCEPT_LICENSE="*"
ACCEPT_KEYWORDS="amd64"
USE="wayland dist-kernel {{ if .hasSound }}pulseaudio{{ end }} -systemd -qtwebengine -webengine {{ if not .hasBluetooth }}-bluetooth{{ end }}"
FEATURES="candy fixlafiles unmerge-orphans noman nodoc noinfo notitles parallel-install parallel-fetch clean-logs"
PORTAGE_SCHEDULING_POLICY="idle"

# NOTE: This stage was built with the bindist USE flag enabled

# This sets the language of build output to English.
# Please keep this setting intact when reporting bugs.
LC_MESSAGES=C.utf8

GENTOO_MIRRORS="https://mirror.rackspace.com/gentoo/ \
    http://mirror.rackspace.com/gentoo/ \
    rsync://mirror.rackspace.com/gentoo/ \
    https://mirror.freedif.org/gentoo \
    http://mirror.freedif.org/gentoo \
    rsync://mirror.freedif.org/gentoo \
    https://mirrors.aliyun.com/gentoo/ \
    http://mirrors.aliyun.com/gentoo/ \
    http://distfiles.gentoo.org"
GRUB_PLATFORMS="efi-64"
